---
title:  내가 모르던 git(3)
date:   2021-12-28 14:08:29 +0900
categories: [git]
tags: [git]
---
# 내가 모르던 git(3)

이 글은 **팀 개발을 위한 Git, GitHub 시작하기** 를 읽고 제가 모르는 부분을 정리한 문서입니다.

### 여러 원격 저장소 히스토리를 한눈에 보자 : 리모트 추가

내 원격 저장소외에도 다른 원격 저장소의 히스토리를 함께 볼 수 있다.

아래 예제의 경우, 2개의 원격 저장소를 같이 보고있는 경우이다. 이런 식으로, 내 브랜치와 원본 저장소를 같이 봄으로써 원격저장소의 변경사항을 빠르게 이해하고 내 것에 반영하는데 도움을 줄 수 있다.

![Untitled](../../assets/img/posts/2021-12-28-git(3)/Untitled.png)

소스트리를 사용하여, 저장소 → 원격 저장소 추가에 들어가서 추가해보도록하자.

이 때, 원격 이름은 관용적으로 `upstream` 이라는 이름을 사용한다.

![Untitled](../../assets/img/posts/2021-12-28-git(3)/Untitled%201.png)

원격 저장소를 추가하면 소스트리 화면 좌측에 `원격` → `upstream` 이 생성된 것을 볼 수 있다.

`fetch` 를 통해서 가져오면 아래와 같이 원본 저장소의 상황과 내 저장소의 상황이 함께 보이는 것을 볼 수 있다.

![Untitled](../../assets/img/posts/2021-12-28-git(3)/Untitled%202.png)

### 묵은 커밋을 새 커밋으로 이력 조작하기(rebase)

`merge` 의 경우, fast-forward 가 아니라면 커밋 이력이 남는다. 개발자가 여럿이라면 이러한 커밋 이력은 가만히 나누기에는 너무 많은 양 일 것이다. 다행히 git은 이러한 상황에 대해 해결책을 가지고 있다. 그게 바로 `rebase` 이다.

`rebase` 는 내가 처음 브랜치를 딴 `base` 커밋을 조작하는 것이다. 아래 사진을 보자.

너구리는 0번 커밋을 `base` 로 커밋이력을 갱신하고 있다. 허나 고양이의 upstream/master에 `merge` 를 하려니 confilct로 인해 `merge` 커밋이력이 쌓이고 만다.

![Untitled](../../assets/img/posts/2021-12-28-git(3)/Untitled%203.png)

`rebase` 는 이러한 상황에서 `base` 인 0번 커밋을 3번 커밋으로 바꿔버리는 방식이다.

![Untitled](../../assets/img/posts/2021-12-28-git(3)/Untitled%204.png)

이러면, fast-forward 방식이기 때문에 별도의 커밋이력이 남지 않는 효과를 가지고 올 수 있다.

허나 이러한 `rebase` 는 이력을 `조작` 하는 것이기에 굉장히 조심해야한다. 만약 다른 사람과 같이 쓰는 branch에서 `rebase` 를 했다면 동료 개발자는 갑자기 바뀐 이력에 어지러워 할 것이다. 그러니 `rebase`는 반드시 혼자만 쓰는 브랜치에서 수행해야 한다.

아래 사진을 보면, 붉은 색의 origin/master 의 커밋베이스는 `좋아요 기능 추가` 였으나, upstream/master의 `개발자 목록에 너구리 추가` 로 커밋 베이스를 옮긴 것을 볼 수 있다.

하지만 이건 로컬에서만 반영 된 것이고 원격에는 반영되지 않았다. 따라서 push를 통해 반영해야하는데 `rebase` 는 이력을 조작한 것이기 때문에 보통 push로는 안되고 force push를 해줘야한다.

![Untitled](../../assets/img/posts/2021-12-28-git(3)/Untitled%205.png)
